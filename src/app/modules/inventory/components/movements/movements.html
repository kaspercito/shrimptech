<div class="page-wrapper">
  <h1 class="section-title">ðŸ”„ Movimientos de Inventario</h1>

  <!-- BOTÃ“N REGISTRAR -->
  <div class="add-button-container">
    <button mat-raised-button class="btn-agregar" (click)="openRegistrarDialog()">
      <mat-icon>add</mat-icon>Registrar Movimiento
    </button>
  </div>

  <!-- FILTROS -->
  <div class="filtros-container">
    <div class="filtros">

      <div class="filtro-item">
        <mat-form-field appearance="outline" class="filtro-material">
          <mat-label>Tipo:</mat-label>
          <mat-select [(ngModel)]="filtroTipo" (selectionChange)="filtrar()">
            <mat-option value="">Todos</mat-option>
            <mat-option value="Entrada">Entrada</mat-option>
            <mat-option value="Salida">Salida</mat-option>
            <mat-option value="Ajuste">Ajuste</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="filtro-item">
        <mat-form-field appearance="outline" class="filtro-material">
          <mat-label>Producto:</mat-label>
          <mat-select [(ngModel)]="filtroProducto" (selectionChange)="filtrar()">
            <mat-option value="">Todos</mat-option>
            <mat-option value="Producto 1">Producto 1</mat-option>
            <mat-option value="Producto 2">Producto 2</mat-option>
            <mat-option value="Producto 3">Producto 3</mat-option>
            <mat-option value="Producto 4">Producto 4</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="filtro-item">
        <mat-form-field appearance="outline" class="filtro-material">
          <mat-label>Desde:</mat-label>
          <input matInput [matDatepicker]="pickerDesde" [(ngModel)]="filtroDesde" (dateChange)="filtrar()">
          <mat-datepicker-toggle matIconSuffix [for]="pickerDesde"></mat-datepicker-toggle>
          <mat-datepicker #pickerDesde></mat-datepicker>
        </mat-form-field>
      </div>

      <div class="filtro-item">
        <mat-form-field appearance="outline" class="filtro-material">
          <mat-label>Hasta:</mat-label>
          <input matInput [matDatepicker]="pickerHasta" [(ngModel)]="filtroHasta" (dateChange)="filtrar()">
          <mat-datepicker-toggle matIconSuffix [for]="pickerHasta"></mat-datepicker-toggle>
          <mat-datepicker #pickerHasta></mat-datepicker>
        </mat-form-field>
      </div>
    </div>
  </div>
  
  <!-- TABLA -->
  <div class="table-container">
    <table mat-table [dataSource]="movimientosFiltrados">

      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef>ID</th>
        <td mat-cell *matCellDef="let m">{{ m.id }}</td>
      </ng-container>

      <ng-container matColumnDef="fecha">
        <th mat-header-cell *matHeaderCellDef>Fecha</th>
        <td mat-cell *matCellDef="let m">{{ m.fecha }}</td>
      </ng-container>

      <ng-container matColumnDef="producto">
        <th mat-header-cell *matHeaderCellDef>Producto</th>
        <td mat-cell *matCellDef="let m">{{ m.producto }}</td>
      </ng-container>

      <ng-container matColumnDef="tipo">
        <th mat-header-cell *matHeaderCellDef>Tipo</th>
        <td mat-cell *matCellDef="let m">{{ m.tipo }}</td>
      </ng-container>

      <ng-container matColumnDef="cantidad">
        <th mat-header-cell *matHeaderCellDef>Cantidad</th>
        <td mat-cell *matCellDef="let m">{{ m.cantidad }}</td>
      </ng-container>

      <ng-container matColumnDef="responsable">
        <th mat-header-cell *matHeaderCellDef>Responsable</th>
        <td mat-cell *matCellDef="let m">{{ m.responsable }}</td>
      </ng-container>

      <ng-container matColumnDef="acciones">
        <th mat-header-cell *matHeaderCellDef>Acciones</th>
        <td mat-cell *matCellDef="let m">
          <mat-icon class="action-icon" (click)="openVerDialog(m)">visibility</mat-icon>
          <mat-icon class="action-icon" (click)="openEditarDialog(m)">edit</mat-icon>
          <mat-icon class="action-icon" (click)="eliminarMovimiento(m.id)">delete</mat-icon>
        </td>
      </ng-container>

      <!-- FILAS -->
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>
</div>
